#pragma once
#include <Windows.h>
#include <map>
#include <iostream>
#include "iceid_header.h"

namespace icedid
{
	BYTE* alloc_pe(IN const iced_module_hdr &hdr, OUT size_t &out_size);

	size_t copy_sections(IN const iced_module_hdr &hdr, IN OUT BYTE* buf, IN const size_t buf_size);

	bool convert_to_pe(const iced_module_hdr& hdr, char* filename);
};

