#include "iceid_parser.h"

#include <iostream>

void icedid::print_sections(const ICED_SECTION &hdr)
{
	std::cout << "virtual_offset:   " << std::hex << hdr.virtual_offset << "\n";
	std::cout << "virtual_size:     " << std::hex << hdr.virtual_size << "\n";
	std::cout << "raw_offset:       " << std::hex << hdr.raw_offset << "\n";
	std::cout << "raw_size:         " << std::hex << hdr.raw_size << "\n";
	std::cout << "characteristics:  " << std::hex << (int)hdr.characteristics << "\n";
}

void icedid::print_header(const iced_module_hdr &hdr)
{
	std::cout << "IceId header:\n";
	std::cout << "Image Base: " << std::hex << hdr.image_base << "\n";
	std::cout << "Image Size: " << std::hex << hdr.image_size << "\n";
	std::cout << "Entry Pint: " << std::hex << hdr.entry_point_va << "\n";
	std::cout << "\n";
	std::cout << "Data Directories:\n";
	std::cout << "Imports Va: " << std::hex << hdr.import_dir_va << "\n";
#ifdef OLD_ICE_FORMAT
	std::cout << "Sections Count: " << std::hex << hdr.import_dir_size << "\n";
#endif
	std::cout << "Relocations VA: " << std::hex << hdr.reloc_dir_va << "\n";
	std::cout << "Relocations Size: " << std::hex << hdr.reloc_dir_size << "\n";
	std::cout << "Sections Count: " << std::hex << hdr.sections_count << "\n";

	std::cout << "Sections:\n";
	for (size_t i = 0; i < hdr.sections_count; i++) {
		std::cout << "---\n#" << i << "\n";
		print_sections(hdr.sections[i]);
	}
};

