#pragma once
#include <stdint.h>

//#define OLD_ICE_FORMAT

#define NEXT_OFFSET 0x10

#pragma pack(push)
#pragma pack(1)
struct ICED_SECTION {
	uint32_t virtual_offset;
	uint32_t virtual_size;
	uint32_t raw_offset;
	uint32_t raw_size;
	uint8_t characteristics;
};

struct iced_module_hdr {
	uint64_t image_base;
	uint32_t image_size;
	uint32_t entry_point_va;
#ifdef OLD_ICE_FORMAT
	uint32_t unknown;
#endif
	uint32_t import_dir_va;
	uint32_t reloc_dir_va;
	uint32_t reloc_dir_size;

	uint32_t sections_count;
	ICED_SECTION sections[1]; // sections[sections_count]
};
#pragma pack(pop)
