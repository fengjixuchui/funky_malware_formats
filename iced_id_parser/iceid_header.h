#pragma once
#include <stdint.h>

#define NEXT_OFFSET 0x10
#pragma push()
#pragma pack(1)
struct ICED_SECTION {
	uint32_t virtual_offset;
	uint32_t virtual_size;
	uint32_t raw_offset;
	uint32_t raw_size;
	uint8_t characteristics;
};

struct iced_module_hdr {
	uint64_t image_base;
	uint32_t image_size;
	uint32_t entry_point_va;

	uint32_t import_dir_va;
	uint32_t reloc_dir_va;
	uint32_t reloc_dir_size;

	uint32_t sections_count;
	ICED_SECTION sections[1]; // sections[sections_count]
};
#pragma pop()
